@page "/categories"
@using BookListManager.Models
@using BookListManager.Repository.IRepository
@inject ICategoryRepository _CategoryRepository

<h3>Categories</h3>

<ul>
    @foreach (var category in categories)
    {
        <li>
            @category.CategoryName
            @if (category.SubCategories != null && category.SubCategories.Any())
            {
                <CategoryTreeView Categories="category.SubCategories" />
            }
        </li>
    }
</ul>

@code {
    private List<Category> categories = new List<Category>();

    // Use OnInitialized instead of OnInitializedAsync
    protected override async void OnInitialized()
    {
        // Load top-level categories with their subcategories (synchronous version)
        //categories = (await _CategoryRepository.GetAll()).ToList();
    }
}
